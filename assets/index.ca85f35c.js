var ft=Object.defineProperty;var Q=Object.getOwnPropertySymbols;var pt=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable;var Z=(o,e,t)=>e in o?ft(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,U=(o,e)=>{for(var t in e||(e={}))pt.call(e,t)&&Z(o,t,e[t]);if(Q)for(var t of Q(e))gt.call(e,t)&&Z(o,t,e[t]);return o};var mt=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var G=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)};var X=(o,e,t)=>(mt(o,e,"access private method"),t);import{r as k,o as v,c as f,a as n,b as _,w as p,d as T,e as bt,f as W,g as c,u as g,t as N,h as $,v as M,i as tt,j as B,k as E,l as K,m as P,n as et,p as xt,M as yt,q as wt,s as nt,F as O,x as ot,y as $t,z as kt,A as Y,B as St,C as It,D as Tt,E as Et,G as Pt,H as Lt,I as Nt}from"./vendor.fedbac92.js";const Mt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}};Mt();var L=(o,e)=>{const t=o.__vccOpts||o;for(const[l,s]of e)t[l]=s;return t};const Ot={},At={class:"content-area"},Bt={class:"content-bar"},Ct=T(" Home "),Vt=T(" Public Place "),Rt=T(" Blogs "),Ut=T(" Are you me? ");function Ft(o,e){const t=k("router-link"),l=k("router-view");return v(),f("div",At,[n("nav",Bt,[_(t,{to:"/"},{default:p(()=>[Ct]),_:1}),_(t,{to:"/public-place"},{default:p(()=>[Vt]),_:1}),_(t,{to:"/blogs"},{default:p(()=>[Rt]),_:1}),_(t,{to:"/auth"},{default:p(()=>[Ut]),_:1})]),_(l)])}var Dt=L(Ot,[["render",Ft]]);console.log({VITE_SUPABASE_URL:"https://tspfjdoknsrfrglseblj.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzcGZqZG9rbnNyZnJnbHNlYmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU1MjI1NzQsImV4cCI6MTk2MTA5ODU3NH0.Uf-K23bCVnxuQVjvQVSqeQoBHSr5B3qJfNaBduseNGk",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0});console.log("https://tspfjdoknsrfrglseblj.supabase.co");const Ht="https://tspfjdoknsrfrglseblj.supabase.co",Jt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzcGZqZG9rbnNyZnJnbHNlYmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU1MjI1NzQsImV4cCI6MTk2MTA5ODU3NH0.Uf-K23bCVnxuQVjvQVSqeQoBHSr5B3qJfNaBduseNGk",S=bt(Ht,Jt);function jt(o,e,t="value"){return e[t]=!1,o.then(function(){e[t]=!0}),o.catch(function(){e[t]=!1}),o}function I(o,e,t="value"){return e[t]=!0,o.then(function(){e[t]=!1}),o.catch(function(){e[t]=!1}),o}const D={authenticated:!1,error:null,user:null,session:null},y=W(U({},D)),H={id:null,handle:null},C=W(U({},H)),st=c(!0);async function lt(o=null,e=null,t=null){if(y.authenticated)return;if(o=o!=null?o:localStorage.getItem("userEmail"),e=e!=null?e:localStorage.getItem("password"),o===void 0||e===void 0){y.authenticated=!1;return}const{user:l,session:s,error:a}=await S.auth.signIn({email:o,password:e});if(a){Object.assign(y,{authenticated:!1,error:a});return}Object.assign(C,(await S.from("user_data").select("*").eq("id",l.id)).data[0]),Object.assign(y,{authenticated:!0,user:l,session:s}),console.log("Logged in"),t&&(localStorage.setItem("userEmail",o),localStorage.setItem("password",e),console.log("Details saved locally"))}async function qt(){localStorage.setItem("userEmail",void 0),localStorage.setItem("password",void 0),console.log("logging out..."),await S.auth.signOut(),Object.assign(y,D),Object.assign(C,H),console.log(D,H),console.log("logged out.")}I(lt(),st).then(()=>{console.log(y),console.log(C)});const zt={class:"nugget-container"},Qt=["onSubmit"],Zt={key:0},Gt=["disabled"],Xt={key:1},Kt=n("td",null,[n("label",{for:"email"},"Email:")],-1),Yt=n("td",null,[n("label",{for:"password"},"Password:")],-1),Wt=["value","disabled"],te={setup(o){const e=c(""),t=c(""),l=c(!1);async function s(){try{console.log("logging..."),await I(lt(e.value,t.value,!0),l)}catch(i){alert(i.error_description||i.error_message)}}async function a(){try{console.log("logging..."),await I(qt(),l)}catch(i){alert(i.error_description||i.error_message)}}return(i,u)=>(v(),f("div",zt,[n("form",{class:"card tight",onSubmit:tt(s,["prevent"])},[g(y).authenticated?(v(),f("div",Zt,[n("h1",null,"Welcome, "+N(g(C).handle),1),n("button",{disabled:l.value,onclick:a},N(l.value?"Bye...":"Log Out"),9,Gt)])):(v(),f("table",Xt,[n("tr",null,[Kt,n("td",null,[$(n("input",{"onUpdate:modelValue":u[0]||(u[0]=d=>e.value=d),class:"inputField",type:"email",name:"email"},null,512),[[M,e.value]])])]),n("tr",null,[Yt,n("td",null,[$(n("input",{"onUpdate:modelValue":u[1]||(u[1]=d=>t.value=d),class:"inputField",type:"password",name:"password"},null,512),[[M,t.value]])])]),n("tr",null,[n("input",{type:"submit",value:l.value?"loading":"Log In",disabled:l.value},null,8,Wt)])]))],40,Qt)]))}},F={loadPost:0,loadTitles:0,submitPost:0},ee={loadPost:10,loadTitles:10,submitPost:3},at="No post with given name exists",ne="Requests are too frequent!";function J(o){if(F[o]<ee[o])F[o]+=1,setTimeout(()=>{F[o]-=1},5e3);else throw Error(ne)}async function it(o){J("loadPost");const{data:e,error:t}=await S.from("posts").select("content").eq("title",o);if(t)throw t;if(e.length===0)throw new Error(`${at}: ${o}`);return{title:o,content:e[0].content,resources:[]}}async function oe(){J("loadTitles");const{data:o,error:e}=await S.from("posts").select("title");if(e)throw e;return o.map(({title:t})=>t)}async function se(o,e){if(J("submitPost"),!y.authenticated){console.error("Cant submit, not authenticated");return}const{error:t}=await S.from("posts").upsert({title:o,content:e,modified:new Date().toISOString()});if(t)throw t}const le=n("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"},null,-1),ct=B({props:{title:null,isLoading:{type:Boolean},externalText:null,externalResources:null},emits:["update:isLoading"],setup(o,{emit:e}){const t=o,l=c(!1);let s=!1;const a=E({get(){return t.isLoading},set(h){console.log("isLoading",h),e("update:isLoading",h)}});let i,u;if(t.externalText!==void 0)i=K(t,"externalText"),u=K(t,"externalResources"),P(i,function(){s=!1});else{const h=c("");i=et(h),u=c([]);const m=async()=>{t.title!==""&&({content:h.value,resources:u.value}=await I(jt(it(t.title),l),a),w())};m(),P(()=>t.title,m)}const d=c("");P(i,function(){d.value=`# ${t.title}
${i.value}`});function w(){if(!s){for(const h of document.querySelectorAll("#blog-preview script")){const m=document.createElement("script");m.innerHTML="{"+h.innerHTML+"}",h.parentElement.appendChild(m),h.remove()}s=!0}}return(h,m)=>(v(),f(O,null,[le,_(g(nt),{id:"blog-preview",class:"card",source:d.value,html:!0,plugins:[{plugin:g(xt),options:{re:/<!--!([^]*?)!-->/g}},{plugin:g(yt),options:{engine:g(wt),delimiters:"dollars",katexOptions:{macros:{}}}}],onFocusin:w},null,8,["source","plugins"])],64))}}),ae=n("label",{for:"markdown-input"}," Select Blog: ",-1),ie={id:"title-list"},ce=["value"],ue=["value","disabled"],ut=B({props:{disabled:{type:Boolean},buttonText:null,notExistsText:null,onSubmit:null},setup(o){const e=o,t=c([]),l=c(""),s=E(()=>!t.value.includes(l.value));async function a(){t.value=await oe()}return ot(a),(i,u)=>(v(),f(O,null,[ae,$(n("input",{id:"markdown-input","onUpdate:modelValue":u[0]||(u[0]=d=>l.value=d),type:"search",list:"title-list",style:{width:"20em"}},null,512),[[M,l.value]]),n("datalist",ie,[(v(!0),f(O,null,$t(t.value,d=>(v(),f("option",{key:d,value:d},null,8,ce))),128))]),n("input",{type:"submit",value:g(s)&&o.notExistsText?o.notExistsText:o.buttonText,disabled:o.disabled,style:{width:"7em"},onClick:u[1]||(u[1]=d=>e.onSubmit(l.value))},null,8,ue)],64))}});var A,re;const z=class{constructor(e,t,l,s,a){G(this,A);this.isSaving=c(!1),this.textMutated=c(0),this.doAutosave=c(!1),this.autosaveTime_=1e4,this.content=t,this.title=e,this.resources=a,this.editArea=l,setInterval(()=>X(this,A,re).call(this),this.autosaveTime_),P(this.content,()=>{console.log("editor:",this),this.textMutated.value+=1}),this.insertText(s,0,this.editArea.value.length)}insertText(e,t=null,l=null){this.editArea.focus(),t!==null&&(this.editArea.selectionStart=t),l!==null&&(this.editArea.selectionEnd=l),document.execCommand("insertText",!1,e)}async save(){console.log("saving..."),await I(se(this.title,this.content.value),this.isSaving),console.log("saved."),this.textMutated.value=0}static async create(e,t,l){let s,a;try{({content:s,resources:a}=await it(e))}catch(i){if(console.log(i),i.message===at)s="";else throw i}return console.log(e,t,l,s),new z(e,t,l,s,a)}};let rt=z;A=new WeakSet,re=function(){this.doAutosave.value&&this.textMutated.value&&this.save()};const j=o=>(Tt("data-v-eae0d7a6"),o=o(),Et(),o),de={class:"content-column no-basis"},_e={class:"content-row tight"},he={class:"content-column tight"},ve=j(()=>n("label",{for:"toggle-autosave"},"Autosave",-1)),fe={class:"content-row"},pe={class:"content-column no-basis"},ge={class:"content-bar"},me=j(()=>n("label",{for:"markdown-input"},"Post Text",-1)),be=[me],xe={key:0},ye=["value","disabled"],we={class:"content-column no-basis"},$e={class:"content-bar"},ke=j(()=>n("h2",null," Post Preview ",-1)),Se=["value"],Ie=B({setup(o){let e=null;function t(){return e}const l=c(""),s=et(l),a=c(!1),i=c(!0),u=c(null),d=c(0),w=c(!1),h=c(""),m=c(!1),V=c(!1);async function dt(b){console.log("editor",e),e&&e.textMutated.value&&confirm("Save changes?")&&e.save(),e=await I(rt.create(b,l,u.value),V),console.log("autosave",w),h.value=e.title,e.isSaving=a,e.doAutosave=w,e.textMutated=d,m.value=!0}const _t=E(()=>i.value?"Show Full Preview":"Show Editor"),ht=E(()=>m.value?d.value+" unsaved characters":"No title selected; changes will not be saved."),vt=E(()=>!st.value&&y.authenticated);return P(s,function(b,r){r.length-b.length>500&&!confirm("Post content contracted significantly. Confirm?")&&e.insertText(r,0,u.value.value.length)}),ot(()=>u.value.addEventListener("keydown",function(b){let r;if(b.key==="Tab")b.preventDefault(),r="  ";else if(b.key==="Enter"){b.preventDefault();const x=this.value.lastIndexOf(`
`,this.selectionStart-1);let R=this.value.slice(x+1,this.selectionStart).search(/[^ ]/);R===-1&&(R=this.selectionStart-x-1),r=`
`+" ".repeat(R)}else return;e.insertText(r)})),(b,r)=>(v(),f("form",{style:{display:"flex"},onSubmit:r[5]||(r[5]=tt(()=>{},["prevent"]))},[n("div",de,[n("div",_e,[n("div",null,[n("h2",null,' Editing "'+N(h.value)+'" ',1)]),n("h2",null,[_(ut,{disabled:V.value,"on-submit":dt,"button-text":V.value?"Loading...":"Load","not-exists-text":"New"},null,8,["disabled","button-text"])]),n("div",he,[n("div",null,[$(n("input",{"onUpdate:modelValue":r[0]||(r[0]=x=>w.value=x),type:"checkbox",name:"toggle-autosave"},null,512),[[kt,w.value]]),ve])])]),n("div",fe,[$(n("div",pe,[n("div",ge,[n("h2",{style:St("font-style: "+(d.value===0?"normal":"italic"))},be,4),$(n("p",{style:{"flex-grow":"1"}},N(g(ht)),513),[[Y,d.value>0]]),g(vt)?(v(),f("span",xe,[n("input",{type:"submit",value:t()&&a.value?"Saving...":"Save",disabled:a.value||!m.value,onClick:r[1]||(r[1]=x=>t().save())},null,8,ye)])):It("",!0)]),$(n("textarea",{id:"markdown-input",ref_key:"markdownInput",ref:u,"onUpdate:modelValue":r[2]||(r[2]=x=>l.value=x),class:"flex-child-fill",disabled:!1,onInput:r[3]||(r[3]=x=>d.value+=1)},null,544),[[M,l.value]])],512),[[Y,i.value]]),n("div",we,[n("div",$e,[ke,n("span",null,[n("input",{type:"submit",value:g(_t),onClick:r[4]||(r[4]=x=>i.value=!i.value)},null,8,Se)])]),_(ct,{title:h.value,"external-text":g(s)},null,8,["title","external-text"])])])])],32))}});var Te=L(Ie,[["__scopeId","data-v-eae0d7a6"]]);const Ee={class:"content-column"},Pe=n("br",null,null,-1),Le={class:"content-row tight"},Ne=T(" Edit "),Me=n("br",null,null,-1),Oe=B({setup(o){const e=c(""),t=c(!1);function l(s){console.log(s),e.value=s}return(s,a)=>{const i=k("router-link");return v(),f("div",Ee,[Pe,n("div",Le,[n("div",null,[_(ut,{"button-text":t.value?"Loading":"Load",disabled:t.value,"on-submit":l},null,8,["button-text","disabled"])]),_(i,{to:"/blog-edit"},{default:p(()=>[Ne]),_:1})]),Me,_(ct,{"is-loading":t.value,"onUpdate:is-loading":a[0]||(a[0]=u=>t.value=u),title:e.value},null,8,["is-loading","title"])])}}});var Ae="/assets/blog_button.8c697ef8.png",Be="/assets/public_button.11df71ad.png";const Ce={},Ve=n("h1",null,"This is the main page yay!",-1),Re={class:"card"},Ue=n("div",{class:"text-content"},[n("h2",null,"What stuff exists here"),n("p",null," This site has a small web app I made for myself to write posts. Perhaps once the organization gets musty enough a system will grow naturally, just like mould on a sandwich. ")],-1),Fe={class:"content-column"},De={class:"content-row"},He={class:"flex-child-fill square mid-margin"},Je=n("img",{class:"img-btn",src:Ae},null,-1),je={class:"flex-child-fill square mid-margin"},qe=n("img",{class:"img-btn",src:Be},null,-1);function ze(o,e){const t=k("router-link");return v(),f(O,null,[Ve,n("div",Re,[Ue,n("div",Fe,[n("div",De,[n("div",He,[_(t,{to:"/blog-edit"},{default:p(()=>[Je]),_:1})]),n("div",je,[_(t,{to:"/public-place"},{default:p(()=>[qe]),_:1})])])])])],64)}var Qe=L(Ce,[["render",ze]]),Ze="/assets/fetus.2d52290a.png";const Ge={},Xe={class:"card"},Ke=n("div",{class:"title"},[n("h1",null,"Public Place")],-1),Ye=n("div",{class:"text-content"},[n("h1",null,"Hello Stranger!"),n("p",null," This is the Public Place. For Public People. Hellooo the public! Please gaze at my various credentials or whatever. ")],-1),We={class:"text-content"},tn=n("h1",null," About Me",-1),en=n("img",{class:"side-img",src:Ze},null,-1),nn=n("p",null," I dont feel particularly inclined to write about boring stuff right now. So youre going to have to settle for a nice picture of me: ",-1),on={class:"link-list"},sn=n("div",{class:"block-link"},[n("p",null,"Resume BROKEN PLEASE FIX ME")],-1),ln=n("div",{class:"block-link"},[n("p",null,"GitHub BROKEN PLEASE FIX ME")],-1),an=n("div",{class:"block-link"},[n("p",null,"Linkedin BROKEN PLEASE FIX ME")],-1),cn=n("div",{class:"block-link"},[n("p",null,"Escape From The Public")],-1);function un(o,e){const t=k("router-link");return v(),f("div",Xe,[Ke,Ye,n("div",We,[tn,en,nn,n("div",null,[n("div",on,[n("ul",null,[n("li",null,[_(t,{to:"blog/blog1.html"},{default:p(()=>[sn]),_:1})]),n("li",null,[_(t,{to:"blog/blog1.html"},{default:p(()=>[ln]),_:1})]),n("li",null,[_(t,{to:"blog/blog1.html"},{default:p(()=>[an]),_:1})]),n("li",null,[_(t,{to:"index.html"},{default:p(()=>[cn]),_:1})])])])])])])}var rn=L(Ge,[["render",un]]);const dn={},_n={class:"centered"},hn={class:"tight"},vn=n("h1",null," i am a failure ",-1),fn=T(" Return Home ");function pn(o,e){const t=k("router-link");return v(),f("div",_n,[n("div",hn,[vn,_(t,{to:"/"},{default:p(()=>[fn]),_:1})])])}var gn=L(dn,[["render",pn]]);const mn=[{path:"/",component:Qe},{path:"/auth",component:te},{path:"/blogs",component:Oe},{path:"/public-place",component:rn},{path:"/blog-edit",component:Te},{path:"/:pathMatch(.*)*",component:gn}],bn=Pt({history:Lt(),routes:mn}),q=Nt(Dt);q.use(bn);q.use(nt);q.mount("#app");
