var ft=Object.defineProperty;var z=Object.getOwnPropertySymbols;var gt=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable;var Q=(o,t,n)=>t in o?ft(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,R=(o,t)=>{for(var n in t||(t={}))gt.call(t,n)&&Q(o,n,t[n]);if(z)for(var n of z(t))pt.call(t,n)&&Q(o,n,t[n]);return o};var mt=(o,t,n)=>{if(!t.has(o))throw TypeError("Cannot "+n)};var Z=(o,t,n)=>{if(t.has(o))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(o):t.set(o,n)};var G=(o,t,n)=>(mt(o,t,"access private method"),n);import{c as bt,r as Y,a as c,o as v,b as f,d as e,u as g,t as E,w as k,v as L,e as W,f as M,g as $,h as X,i as T,j as tt,k as _,m as xt,M as yt,l as wt,n as et,F as P,p as nt,q as kt,s as St,x as K,y as It,z as $t,A as Tt,B as Et,C as O,D as y,E as ot,G as Lt,H as Pt,I as Nt}from"./vendor.8b298f2f.js";const Mt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};Mt();console.log({VITE_SUPABASE_URL:"https://tspfjdoknsrfrglseblj.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzcGZqZG9rbnNyZnJnbHNlYmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU1MjI1NzQsImV4cCI6MTk2MTA5ODU3NH0.Uf-K23bCVnxuQVjvQVSqeQoBHSr5B3qJfNaBduseNGk",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0});console.log("https://tspfjdoknsrfrglseblj.supabase.co");const Ot="https://tspfjdoknsrfrglseblj.supabase.co",At="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzcGZqZG9rbnNyZnJnbHNlYmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU1MjI1NzQsImV4cCI6MTk2MTA5ODU3NH0.Uf-K23bCVnxuQVjvQVSqeQoBHSr5B3qJfNaBduseNGk",S=bt(Ot,At);function Ct(o,t,n="value"){return t[n]=!1,o.then(function(){t[n]=!0}),o.catch(function(){t[n]=!1}),o}function I(o,t,n="value"){return t[n]=!0,o.then(function(){t[n]=!1}),o.catch(function(){t[n]=!1}),o}const F={authenticated:!1,error:null,user:null,session:null},x=Y(R({},F)),D={id:null,handle:null},A=Y(R({},D)),st=c(!0);async function lt(o=null,t=null,n=null){if(x.authenticated)return;if(o=o!=null?o:localStorage.getItem("userEmail"),t=t!=null?t:localStorage.getItem("password"),o===void 0||t===void 0){x.authenticated=!1;return}const{user:l,session:s,error:a}=await S.auth.signIn({email:o,password:t});if(a){Object.assign(x,{authenticated:!1,error:a});return}Object.assign(A,(await S.from("user_data").select("*").eq("id",l.id)).data[0]),Object.assign(x,{authenticated:!0,user:l,session:s}),console.log("Logged in"),n&&(localStorage.setItem("userEmail",o),localStorage.setItem("password",t),console.log("Details saved locally"))}async function Bt(){localStorage.setItem("userEmail",void 0),localStorage.setItem("password",void 0),console.log("logging out..."),await S.auth.signOut(),Object.assign(x,F),Object.assign(A,D),console.log(F,D),console.log("logged out.")}I(lt(),st).then(()=>{console.log(x),console.log(A)});const Vt={class:"nugget-container"},Rt=["onSubmit"],Ut={key:0},Ft=["disabled"],Dt={key:1},Jt=e("td",null,[e("label",{for:"email"},"Email:")],-1),Ht=e("td",null,[e("label",{for:"password"},"Password:")],-1),jt=["value","disabled"],qt={setup(o){const t=c(""),n=c(""),l=c(!1);async function s(){try{console.log("logging..."),await I(lt(t.value,n.value,!0),l)}catch(i){alert(i.error_description||i.error_message)}}async function a(){try{console.log("logging..."),await I(Bt(),l)}catch(i){alert(i.error_description||i.error_message)}}return(i,u)=>(v(),f("div",Vt,[e("form",{class:"card tight",onSubmit:W(s,["prevent"])},[g(x).authenticated?(v(),f("div",Ut,[e("h1",null,"Welcome, "+E(g(A).handle),1),e("button",{disabled:l.value,onclick:a},E(l.value?"Bye...":"Log Out"),9,Ft)])):(v(),f("table",Dt,[e("tr",null,[Jt,e("td",null,[k(e("input",{"onUpdate:modelValue":u[0]||(u[0]=d=>t.value=d),class:"inputField",type:"email",name:"email"},null,512),[[L,t.value]])])]),e("tr",null,[Ht,e("td",null,[k(e("input",{"onUpdate:modelValue":u[1]||(u[1]=d=>n.value=d),class:"inputField",type:"password",name:"password"},null,512),[[L,n.value]])])]),e("tr",null,[e("input",{type:"submit",value:l.value?"loading":"Log In",disabled:l.value},null,8,jt)])]))],40,Rt)]))}},U={loadPost:0,loadTitles:0,submitPost:0},zt={loadPost:10,loadTitles:10,submitPost:3},at="No post with given name exists",Qt="Requests are too frequent!";function J(o){if(U[o]<zt[o])U[o]+=1,setTimeout(()=>{U[o]-=1},5e3);else throw Error(Qt)}async function it(o){J("loadPost");const{data:t,error:n}=await S.from("posts").select("content").eq("title",o);if(n)throw n;if(t.length===0)throw new Error(`${at}: ${o}`);return{title:o,content:t[0].content,resources:[]}}async function Zt(){J("loadTitles");const{data:o,error:t}=await S.from("posts").select("title");if(t)throw t;return o.map(({title:n})=>n)}async function Gt(o,t){if(J("submitPost"),!x.authenticated){console.error("Cant submit, not authenticated");return}const{error:n}=await S.from("posts").upsert({title:o,content:t,modified:new Date().toISOString()});if(n)throw n}const Xt=e("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"},null,-1),ct=M({props:{title:null,isLoading:{type:Boolean},externalText:null,externalResources:null},emits:["update:isLoading"],setup(o,{emit:t}){const n=o,l=c(!1);let s=!1;const a=$({get(){return n.isLoading},set(h){console.log("isLoading",h),t("update:isLoading",h)}});let i,u;if(n.externalText!==void 0)i=X(n,"externalText"),u=X(n,"externalResources"),T(i,function(){s=!1});else{const h=c("");i=tt(h),u=c([]);const p=async()=>{n.title!==""&&({content:h.value,resources:u.value}=await I(Ct(it(n.title),l),a),w())};p(),T(()=>n.title,p)}const d=c("");T(i,function(){d.value=`# ${n.title}
${i.value}`});function w(){if(!s){for(const h of document.querySelectorAll("#blog-preview script")){const p=document.createElement("script");p.innerHTML="{"+h.innerHTML+"}",h.parentElement.appendChild(p),h.remove()}s=!0}}return(h,p)=>(v(),f(P,null,[Xt,_(g(et),{id:"blog-preview",class:"card",source:d.value,html:!0,plugins:[{plugin:g(xt),options:{re:/<!--!([^]*?)!-->/g}},{plugin:g(yt),options:{engine:g(wt),delimiters:"dollars",katexOptions:{macros:{}}}}],onFocusin:w},null,8,["source","plugins"])],64))}}),Kt=e("label",{for:"markdown-input"}," Select Blog: ",-1),Yt={id:"title-list"},Wt=["value"],te=["value","disabled"],ut=M({props:{disabled:{type:Boolean},buttonText:null,notExistsText:null,onSubmit:null},setup(o){const t=o,n=c([]),l=c(""),s=$(()=>!n.value.includes(l.value));async function a(){n.value=await Zt()}return nt(a),(i,u)=>(v(),f(P,null,[Kt,k(e("input",{id:"markdown-input","onUpdate:modelValue":u[0]||(u[0]=d=>l.value=d),type:"search",list:"title-list",style:{width:"20em"}},null,512),[[L,l.value]]),e("datalist",Yt,[(v(!0),f(P,null,kt(n.value,d=>(v(),f("option",{key:d,value:d},null,8,Wt))),128))]),e("input",{type:"submit",value:g(s)&&o.notExistsText?o.notExistsText:o.buttonText,disabled:o.disabled,style:{width:"7em"},onClick:u[1]||(u[1]=d=>t.onSubmit(l.value))},null,8,te)],64))}});var N,ee;const q=class{constructor(t,n,l,s,a){Z(this,N);this.isSaving=c(!1),this.textMutated=c(0),this.doAutosave=c(!1),this.autosaveTime_=1e4,this.content=n,this.title=t,this.resources=a,this.editArea=l,setInterval(()=>G(this,N,ee).call(this),this.autosaveTime_),T(this.content,()=>{console.log("editor:",this),this.textMutated.value+=1}),this.insertText(s,0,this.editArea.value.length)}insertText(t,n=null,l=null){this.editArea.focus(),n!==null&&(this.editArea.selectionStart=n),l!==null&&(this.editArea.selectionEnd=l),document.execCommand("insertText",!1,t)}async save(){console.log("saving..."),await I(Gt(this.title,this.content.value),this.isSaving),console.log("saved."),this.textMutated.value=0}static async create(t,n,l){let s,a;try{({content:s,resources:a}=await it(t))}catch(i){if(console.log(i),i.message===at)s="";else throw i}return console.log(t,n,l,s),new q(t,n,l,s,a)}};let rt=q;N=new WeakSet,ee=function(){this.doAutosave.value&&this.textMutated.value&&this.save()};var C=(o,t)=>{const n=o.__vccOpts||o;for(const[l,s]of t)n[l]=s;return n};const H=o=>(Tt("data-v-eae0d7a6"),o=o(),Et(),o),ne={class:"content-column no-basis"},oe={class:"content-row tight"},se={class:"content-column tight"},le=H(()=>e("label",{for:"toggle-autosave"},"Autosave",-1)),ae={class:"content-row"},ie={class:"content-column no-basis"},ce={class:"content-bar"},ue=H(()=>e("label",{for:"markdown-input"},"Post Text",-1)),re=[ue],de={key:0},he=["value","disabled"],_e={class:"content-column no-basis"},ve={class:"content-bar"},fe=H(()=>e("h2",null," Post Preview ",-1)),ge=["value"],pe=M({setup(o){let t=null;function n(){return t}const l=c(""),s=tt(l),a=c(!1),i=c(!0),u=c(null),d=c(0),w=c(!1),h=c(""),p=c(!1),B=c(!1);async function dt(m){console.log("editor",t),t&&t.textMutated.value&&confirm("Save changes?")&&t.save(),t=await I(rt.create(m,l,u.value),B),console.log("autosave",w),h.value=t.title,t.isSaving=a,t.doAutosave=w,t.textMutated=d,p.value=!0}const ht=$(()=>i.value?"Show Full Preview":"Show Editor"),_t=$(()=>p.value?d.value+" unsaved characters":"No title selected; changes will not be saved."),vt=$(()=>!st.value&&x.authenticated);return T(s,function(m,r){r.length-m.length>500&&!confirm("Post content contracted significantly. Confirm?")&&t.insertText(r,0,u.value.value.length)}),nt(()=>u.value.addEventListener("keydown",function(m){let r;if(m.key==="Tab")m.preventDefault(),r="  ";else if(m.key==="Enter"){m.preventDefault();const b=this.value.lastIndexOf(`
`,this.selectionStart-1);let V=this.value.slice(b+1,this.selectionStart).search(/[^ ]/);V===-1&&(V=this.selectionStart-b-1),r=`
`+" ".repeat(V)}else return;t.insertText(r)})),(m,r)=>(v(),f("form",{style:{display:"flex"},onSubmit:r[5]||(r[5]=W(()=>{},["prevent"]))},[e("div",ne,[e("div",oe,[e("div",null,[e("h2",null,' Editing "'+E(h.value)+'" ',1)]),e("h2",null,[_(ut,{disabled:B.value,"on-submit":dt,"button-text":B.value?"Loading...":"Load","not-exists-text":"New"},null,8,["disabled","button-text"])]),e("div",se,[e("div",null,[k(e("input",{"onUpdate:modelValue":r[0]||(r[0]=b=>w.value=b),type:"checkbox",name:"toggle-autosave"},null,512),[[St,w.value]]),le])])]),e("div",ae,[k(e("div",ie,[e("div",ce,[e("h2",{style:It("font-style: "+(d.value===0?"normal":"italic"))},re,4),k(e("p",{style:{"flex-grow":"1"}},E(g(_t)),513),[[K,d.value>0]]),g(vt)?(v(),f("span",de,[e("input",{type:"submit",value:n()&&a.value?"Saving...":"Save",disabled:a.value||!p.value,onClick:r[1]||(r[1]=b=>n().save())},null,8,he)])):$t("",!0)]),k(e("textarea",{id:"markdown-input",ref_key:"markdownInput",ref:u,"onUpdate:modelValue":r[2]||(r[2]=b=>l.value=b),class:"flex-child-fill",disabled:!1,onInput:r[3]||(r[3]=b=>d.value+=1)},null,544),[[L,l.value]])],512),[[K,i.value]]),e("div",_e,[e("div",ve,[fe,e("span",null,[e("input",{type:"submit",value:g(ht),onClick:r[4]||(r[4]=b=>i.value=!i.value)},null,8,ge)])]),_(ct,{title:h.value,"external-text":g(s)},null,8,["title","external-text"])])])])],32))}});var me=C(pe,[["__scopeId","data-v-eae0d7a6"]]);const be={class:"content-column"},xe=e("br",null,null,-1),ye={class:"content-row tight"},we=ot(" Edit "),ke=e("br",null,null,-1),Se=M({setup(o){const t=c(""),n=c(!1);function l(s){console.log(s),t.value=s}return(s,a)=>{const i=O("router-link");return v(),f("div",be,[xe,e("div",ye,[e("div",null,[_(ut,{"button-text":n.value?"Loading":"Load",disabled:n.value,"on-submit":l},null,8,["button-text","disabled"])]),_(i,{to:"/blog-edit"},{default:y(()=>[we]),_:1})]),ke,_(ct,{"is-loading":n.value,"onUpdate:is-loading":a[0]||(a[0]=u=>n.value=u),title:t.value},null,8,["is-loading","title"])])}}});var Ie="/assets/blog_button.8c697ef8.png",$e="/assets/public_button.11df71ad.png";const Te={},Ee=e("h1",null,"This is the main page yay!",-1),Le={class:"card"},Pe=e("div",{class:"text-content"},[e("h2",null,"What stuff exists here"),e("p",null," This site has a small web app I made for myself to write posts. Perhaps once the organization gets musty enough a system will grow naturally, just like mould on a sandwich. ")],-1),Ne={class:"content-column"},Me={class:"content-row"},Oe={class:"flex-child-fill square mid-margin"},Ae=e("img",{class:"img-btn",src:Ie},null,-1),Ce={class:"flex-child-fill square mid-margin"},Be=e("img",{class:"img-btn",src:$e},null,-1);function Ve(o,t){const n=O("router-link");return v(),f(P,null,[Ee,e("div",Le,[Pe,e("div",Ne,[e("div",Me,[e("div",Oe,[_(n,{to:"/blog-edit"},{default:y(()=>[Ae]),_:1})]),e("div",Ce,[_(n,{to:"/public-place"},{default:y(()=>[Be]),_:1})])])])])],64)}var Re=C(Te,[["render",Ve]]),Ue="/assets/fetus.2d52290a.png";const Fe={},De={class:"card"},Je=e("div",{class:"title"},[e("h1",null,"Public Place")],-1),He=e("div",{class:"text-content"},[e("h1",null,"Hello Stranger!"),e("p",null," This is the Public Place. For Public People. Hellooo the public! Please gaze at my various credentials or whatever. ")],-1),je={class:"text-content"},qe=e("h1",null," About Me",-1),ze=e("img",{class:"side-img",src:Ue},null,-1),Qe=e("p",null," I dont feel particularly inclined to write about boring stuff right now. So youre going to have to settle for a nice picture of me: ",-1),Ze={class:"link-list"},Ge=e("div",{class:"block-link"},[e("p",null,"Resume BROKEN PLEASE FIX ME")],-1),Xe=e("div",{class:"block-link"},[e("p",null,"GitHub BROKEN PLEASE FIX ME")],-1),Ke=e("div",{class:"block-link"},[e("p",null,"Linkedin BROKEN PLEASE FIX ME")],-1),Ye=e("div",{class:"block-link"},[e("p",null,"Escape From The Public")],-1);function We(o,t){const n=O("router-link");return v(),f("div",De,[Je,He,e("div",je,[qe,ze,Qe,e("div",null,[e("div",Ze,[e("ul",null,[e("li",null,[_(n,{to:"blog/blog1.html"},{default:y(()=>[Ge]),_:1})]),e("li",null,[_(n,{to:"blog/blog1.html"},{default:y(()=>[Xe]),_:1})]),e("li",null,[_(n,{to:"blog/blog1.html"},{default:y(()=>[Ke]),_:1})]),e("li",null,[_(n,{to:"index.html"},{default:y(()=>[Ye]),_:1})])])])])])])}var tn=C(Fe,[["render",We]]);const en={},nn={class:"centered"},on={class:"tight"},sn=e("h1",null," i am a failure ",-1),ln=ot(" Return Home ");function an(o,t){const n=O("router-link");return v(),f("div",nn,[e("div",on,[sn,_(n,{to:"/"},{default:y(()=>[ln]),_:1})])])}var cn=C(en,[["render",an]]);const un=[{path:"/",component:Re},{path:"/auth",component:qt},{path:"/blogs",component:Se},{path:"/public-place",component:tn},{path:"/blog-edit",component:me},{path:"/:pathMatch(.*)*",component:cn}],rn=Lt({history:Pt(),routes:un}),j=Nt({});j.use(rn);j.use(et);j.mount("#app");
