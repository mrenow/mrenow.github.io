var ut=Object.defineProperty;var G=Object.getOwnPropertySymbols;var rt=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var K=(o,n,t)=>n in o?ut(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t,J=(o,n)=>{for(var t in n||(n={}))rt.call(n,t)&&K(o,t,n[t]);if(G)for(var t of G(n))dt.call(n,t)&&K(o,t,n[t]);return o};import{r as E,o as _,c as v,a as e,b as d,w as y,d as M,e as _t,f as q,g as r,h as T,i as C,j as vt,k as z,l as W,u as w,m as ft,M as ht,n as tt,p as N,t as X,q as I,s as pt,F as O,v as et,x as L,y as R,z as U,A as gt,B as Y,C as mt,D as bt,E as nt,G as yt,H as xt,I as wt,J as kt,K as $t,L as St}from"./vendor.552d0035.js";const It=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=t(l);fetch(l.href,a)}};It();var B=(o,n)=>{const t=o.__vccOpts||o;for(const[s,l]of n)t[s]=l;return t};const Lt={},Et={class:"content-area"},Pt={class:"content-bar"},Mt=M(" Home "),Tt=M(" Public Place "),Nt=M(" Blogs "),Ot=M(" Are you me? ");function At(o,n){const t=E("router-link"),s=E("router-view");return _(),v("div",Et,[e("nav",Pt,[d(t,{to:"/"},{default:y(()=>[Mt]),_:1}),d(t,{to:"/public-place"},{default:y(()=>[Tt]),_:1}),d(t,{to:"/blogs"},{default:y(()=>[Nt]),_:1}),d(t,{to:"/auth"},{default:y(()=>[Ot]),_:1})]),d(s)])}var Bt=B(Lt,[["render",At]]);console.log({VITE_SUPABASE_URL:"https://tspfjdoknsrfrglseblj.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzcGZqZG9rbnNyZnJnbHNlYmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU1MjI1NzQsImV4cCI6MTk2MTA5ODU3NH0.Uf-K23bCVnxuQVjvQVSqeQoBHSr5B3qJfNaBduseNGk",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0});console.log("https://tspfjdoknsrfrglseblj.supabase.co");const Vt="https://tspfjdoknsrfrglseblj.supabase.co",Ct="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzcGZqZG9rbnNyZnJnbHNlYmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU1MjI1NzQsImV4cCI6MTk2MTA5ODU3NH0.Uf-K23bCVnxuQVjvQVSqeQoBHSr5B3qJfNaBduseNGk",P=_t(Vt,Ct);function Rt(o,n,t="value"){return n[t]=!1,o.then(function(){n[t]=!0}),o.catch(function(){n[t]=!1}),o}function A(o,n,t="value"){return n[t]=!0,o.then(function(){n[t]=!1}),o.catch(function(){n[t]=!1}),o}const Ut=(...o)=>{console.log(...o)},H={authenticated:!1,error:null,user:null,session:null},$=q(J({},H)),j={id:null,handle:null},V=q(J({},j)),ot=r(!0);async function st(o=null,n=null,t=null){if($.authenticated)return;if(o=o!=null?o:localStorage.getItem("userEmail"),n=n!=null?n:localStorage.getItem("password"),o===void 0||n===void 0){$.authenticated=!1;return}const{user:s,session:l,error:a}=await P.auth.signIn({email:o,password:n});if(a){Object.assign($,{authenticated:!1,error:a});return}Object.assign(V,(await P.from("user_data").select("*").eq("id",s.id)).data[0]),Object.assign($,{authenticated:!0,user:s,session:l}),console.log("Logged in"),t&&(localStorage.setItem("userEmail",o),localStorage.setItem("password",n),console.log("Details saved locally"))}async function Ft(){localStorage.setItem("userEmail",void 0),localStorage.setItem("password",void 0),console.log("logging out..."),await P.auth.signOut(),Object.assign($,H),Object.assign(V,j),console.log(H,j),console.log("logged out.")}A(st(),ot).then(()=>{console.log($),console.log(V)});const D={loadPost:0,loadTitles:0,submitPost:0},Jt={loadPost:10,loadTitles:10,submitPost:3};class lt extends Error{constructor(n){super(`No post with given name ${n} exists`)}}const Dt="Requests are too frequent!";function Q(o){if(D[o]<Jt[o])D[o]+=1,setTimeout(()=>{D[o]-=1},5e3);else throw Error(Dt)}async function at(o){Q("loadPost");const{data:n,error:t}=await P.from("posts").select("content").eq("title",o);if(t)throw t;if(n.length===0)throw new lt(o);return{title:o,content:n[0].content,resources:[]}}async function Ht(){Q("loadTitles");const{data:o,error:n}=await P.from("posts").select("title");if(n)throw n;return o.map(({title:t})=>t)}async function jt(o,n){if(Q("submitPost"),!$.authenticated){console.error("Cant submit, not authenticated");return}const{error:t,data:s}=await P.from("posts").upsert({title:o,content:n,owner:V.id,modified:new Date().toISOString()});if(t)throw t;return s}const qt=T({props:{source:null},setup(o){const n=o;return console.log("Rerendered"),C(()=>n.source,()=>Ut("reran",n.source)),vt(()=>console.log("Updated")),z(()=>console.log("Mounted")),(t,s)=>(_(),W(w(tt),{source:o.source,html:!0,plugins:[{plugin:w(ft),options:{re:/<html>!([^]*?)<\/html>/}},{plugin:w(ht)}]},null,8,["source","plugins"]))}});const zt=e("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"},null,-1),it=T({props:{title:null,isLoading:{type:Boolean},externalText:null,externalResources:null},emits:["update:isLoading"],setup(o,{emit:n}){const t=o,s=r(!1);let l=!1;const a=N({get(){return t.isLoading},set(h){console.log("isLoading",h),n("update:isLoading",h)}});let i,u;if(t.externalText!==void 0)console.log("taking from editor"),i=X(t,"externalText"),u=X(t,"externalResources"),C(i,function(){l=!1});else{const h=r("");i=I(h),u=r([]);const b=async()=>{t.title!==""&&({content:h.value,resources:u.value}=await A(Rt(at(t.title),s),a),x())};b(),C(()=>t.title,b)}let f=1;const S=q([{data:"",key:0}]);m(),C(()=>[i.value,t.title],m);function m(){performance.now();const h=[`# ${t.title}`].concat(i.value.split(/\s*\n\s*\n/));let b=0;for(const{count:c,added:g,removed:p,value:k}of pt(S.map(({data:F})=>F),h)){if(g){S.splice(b,0,...k.map(F=>({data:F,key:f++}))),b+=c;continue}if(p){S.splice(b,c);continue}b+=c}}function x(){if(!l){for(const h of document.querySelectorAll("#blog-preview script")){const b=document.createElement("script");b.innerHTML="{"+h.innerHTML+"}",h.parentElement.appendChild(b),h.remove()}l=!0}}return(h,b)=>(_(),v(O,null,[zt,e("div",{id:"blog-preview",class:"card",onFocusin:x},[(_(!0),v(O,null,et(w(S),c=>(_(),W(qt,{source:c.data,key:c.key},null,8,["source"]))),128))],32)],64))}}),Qt=e("label",{for:"markdown-input"}," Select Blog: ",-1),Zt={id:"title-list"},Gt=["value"],Kt=["value","disabled"],ct=T({props:{disabled:{type:Boolean},buttonText:null,notExistsText:null,onSubmit:null},setup(o){const n=o,t=r([]),s=r(""),l=N(()=>!t.value.includes(s.value));async function a(){t.value=await Ht()}return z(a),(i,u)=>(_(),v(O,null,[Qt,L(e("input",{id:"markdown-input","onUpdate:modelValue":u[0]||(u[0]=f=>s.value=f),type:"search",list:"title-list",style:{width:"20em"}},null,512),[[R,s.value]]),e("datalist",Zt,[(_(!0),v(O,null,et(t.value,f=>(_(),v("option",{key:f,value:f},null,8,Gt))),128))]),e("input",{type:"submit",value:w(l)&&o.notExistsText?o.notExistsText:o.buttonText,disabled:o.disabled,style:{width:"7em"},onClick:u[1]||(u[1]=f=>n.onSubmit(s.value))},null,8,Kt)],64))}}),Xt=T({setup(o,{expose:n}){const t=r(0),s=r(!1),l=r(!1),a=r(""),i=r(null),u=r(""),f=r([]);async function S(c){if(c===a.value)return;const g=s.value;s.value=!1;try{let p;try{p=await at(c)}catch(k){if(console.log(k),k instanceof lt)p={content:"",resources:[]};else throw k}await m(p.content),a.value=c,s.value=!0}catch(p){console.error("Something went wrong when loading the post:",p),s.value=g}}async function m(c){if(console.log(t.value),t.value!==0&&confirm("Save unsaved changes?")&&!await x())throw new Error("Save Failure");h(c,0,i.value.value.length),t.value=0}async function x(){console.log("saving...");try{const c=t.value,g=await A(jt(a.value,u.value),l);return console.log("saved."),t.value-=c,!0}catch(c){return console.log("save failed."),console.log(c),!1}}function h(c,g=null,p=null){i.value.focus(),console.log(i.value.focus),g!==null&&(i.value.selectionStart=g),p!==null&&(i.value.selectionEnd=p),document.execCommand("insertText",!1,c)}const b={changePost:S,save:x,saveable:I(s),isSaving:I(l),textMutated:I(t),title:I(a),content:I(u),resources:I(f)};return n(b),z(()=>i.value.addEventListener("keydown",function(c){s.value&&(t.value+=1);let g;if(c.key==="Tab")c.preventDefault(),g="  ";else if(c.key==="Enter"){c.preventDefault();const p=this.value.lastIndexOf(`
`,this.selectionStart-1);let k=this.value.slice(p+1,this.selectionStart).search(/[^ ]/);k===-1&&(k=this.selectionStart-p-1),g=`
`+" ".repeat(k)}else return;h(g)})),(c,g)=>L((_(),v("textarea",{class:"flex-child-fill",ref_key:"editArea",ref:i,"onUpdate:modelValue":g[0]||(g[0]=p=>u.value=p)},`
        
    `,512)),[[R,u.value]])}});const Z=o=>(yt("data-v-43d31caa"),o=o(),xt(),o),Yt={class:"content-column no-basis"},Wt={class:"content-row tight"},te={class:"content-column tight"},ee=Z(()=>e("label",{for:"toggle-autosave"},"Autosave",-1)),ne={class:"content-row"},oe={class:"content-column no-basis"},se={class:"content-bar"},le=Z(()=>e("label",{for:"markdown-input"},"Post Text",-1)),ae=[le],ie={key:0},ce=["value","disabled"],ue={class:"content-column no-basis"},re={class:"content-bar"},de=Z(()=>e("h2",null," Post Preview ",-1)),_e=["value"],ve=T({setup(o){const n=r({content:"",title:""}),t=r(!0),s=r(!1),l=r(!1),a=N(()=>t.value?"Show Full Preview":"Show Editor"),i=N(()=>n.value.textMutated?n.value.textMutated+" unsaved characters":"No title selected; changes will not be saved."),u=N(()=>!ot.value&&$.authenticated);function f(){s.value&&n.value.textMutated&&n.value.save()}return setInterval(()=>f(),2e4),(S,m)=>(_(),v("form",{style:{display:"flex"},onSubmit:m[3]||(m[3]=nt(()=>{},["prevent"]))},[e("div",Yt,[e("div",Wt,[e("div",null,[e("h2",null,' Editing "'+U(n.value.title)+'" ',1)]),e("h2",null,[d(ct,{disabled:l.value,"on-submit":n.value.changePost,"button-text":l.value?"Loading...":"Load","not-exists-text":"New"},null,8,["disabled","on-submit","button-text"])]),e("div",te,[e("div",null,[L(e("input",{"onUpdate:modelValue":m[0]||(m[0]=x=>s.value=x),type:"checkbox",name:"toggle-autosave"},null,512),[[gt,s.value]]),ee])])]),e("div",ne,[L(e("div",oe,[e("div",se,[e("h2",{style:mt("font-style: "+(n.value.textMutated===0?"normal":"italic"))},ae,4),L(e("p",{style:{"flex-grow":"1"}},U(w(i)),513),[[Y,n.value.textMutated>0]]),w(u)?(_(),v("span",ie,[e("input",{type:"submit",value:n.value.isSaving?"Saving...":"Save",disabled:n.value.isSaving||!n.value.saveable,onClick:m[1]||(m[1]=(...x)=>n.value.save&&n.value.save(...x))},null,8,ce)])):bt("",!0)]),d(Xt,{ref_key:"editor",ref:n},null,512)],512),[[Y,t.value]]),e("div",ue,[e("div",re,[de,e("span",null,[e("input",{type:"submit",value:w(a),onClick:m[2]||(m[2]=x=>t.value=!t.value)},null,8,_e)])]),d(it,{title:n.value.title,"external-text":n.value.content},null,8,["title","external-text"])])])])],32))}});var fe=B(ve,[["__scopeId","data-v-43d31caa"]]);const he={class:"content-column"},pe=e("br",null,null,-1),ge={class:"content-row tight"},me=M(" Edit "),be=e("br",null,null,-1),ye=T({setup(o){const n=r(""),t=r(!1);function s(l){console.log(l),n.value=l}return(l,a)=>{const i=E("router-link");return _(),v("div",he,[pe,e("div",ge,[e("div",null,[d(ct,{"button-text":t.value?"Loading":"Load",disabled:t.value,"on-submit":s},null,8,["button-text","disabled"])]),d(i,{to:"/blog-edit"},{default:y(()=>[me]),_:1})]),be,d(it,{"is-loading":t.value,"onUpdate:is-loading":a[0]||(a[0]=u=>t.value=u),title:n.value},null,8,["is-loading","title"])])}}}),xe={class:"nugget-container"},we=["onSubmit"],ke={key:0},$e=["disabled"],Se={key:1},Ie=e("td",null,[e("label",{for:"email"},"Email:")],-1),Le=e("td",null,[e("label",{for:"password"},"Password:")],-1),Ee=["value","disabled"],Pe={setup(o){const n=r(""),t=r(""),s=r(!1);async function l(){try{console.log("logging..."),await A(st(n.value,t.value,!0),s)}catch(i){alert(i.error_description||i.error_message)}}async function a(){try{console.log("logging..."),await A(Ft(),s)}catch(i){alert(i.error_description||i.error_message)}}return(i,u)=>(_(),v("div",xe,[e("form",{class:"card tight",onSubmit:nt(l,["prevent"])},[w($).authenticated?(_(),v("div",ke,[e("h1",null,"Welcome, "+U(w(V).handle),1),e("button",{disabled:s.value,onclick:a},U(s.value?"Bye...":"Log Out"),9,$e)])):(_(),v("table",Se,[e("tr",null,[Ie,e("td",null,[L(e("input",{"onUpdate:modelValue":u[0]||(u[0]=f=>n.value=f),class:"inputField",type:"email",name:"email"},null,512),[[R,n.value]])])]),e("tr",null,[Le,e("td",null,[L(e("input",{"onUpdate:modelValue":u[1]||(u[1]=f=>t.value=f),class:"inputField",type:"password",name:"password"},null,512),[[R,t.value]])])]),e("tr",null,[e("input",{type:"submit",value:s.value?"loading":"Log In",disabled:s.value},null,8,Ee)])]))],40,we)]))}};var Me="/assets/blog_button.8c697ef8.png",Te="/assets/public_button.11df71ad.png";const Ne={},Oe=e("h1",null,"This is the main page yay!",-1),Ae={class:"card"},Be=e("div",{class:"text-content"},[e("h2",null,"What stuff exists here"),e("p",null," This site has a small web app I made for myself to write posts. Perhaps once the organization gets musty enough a system will grow naturally, just like mould on a sandwich. ")],-1),Ve={class:"content-column"},Ce={class:"content-row"},Re={class:"flex-child-fill square mid-margin"},Ue=e("img",{class:"img-btn",src:Me},null,-1),Fe={class:"flex-child-fill square mid-margin"},Je=e("img",{class:"img-btn",src:Te},null,-1);function De(o,n){const t=E("router-link");return _(),v(O,null,[Oe,e("div",Ae,[Be,e("div",Ve,[e("div",Ce,[e("div",Re,[d(t,{to:"/blog-edit"},{default:y(()=>[Ue]),_:1})]),e("div",Fe,[d(t,{to:"/public-place"},{default:y(()=>[Je]),_:1})])])])])],64)}var He=B(Ne,[["render",De]]),je="/assets/fetus.2d52290a.png";const qe={},ze={class:"card"},Qe=e("div",{class:"title"},[e("h1",null,"Public Place")],-1),Ze=e("div",{class:"text-content"},[e("h1",null,"Hello Stranger!"),e("p",null," This is the Public Place. For Public People. Hellooo the public! Please gaze at my various credentials or whatever. ")],-1),Ge={class:"text-content"},Ke=e("h1",null," About Me",-1),Xe=e("img",{class:"side-img",src:je},null,-1),Ye=e("p",null," I dont feel particularly inclined to write about boring stuff right now. So youre going to have to settle for a nice picture of me: ",-1),We={class:"link-list"},tn=e("div",{class:"block-link"},[e("p",null,"Resume BROKEN PLEASE FIX ME")],-1),en=e("div",{class:"block-link"},[e("p",null,"GitHub BROKEN PLEASE FIX ME")],-1),nn=e("div",{class:"block-link"},[e("p",null,"Linkedin BROKEN PLEASE FIX ME")],-1),on=e("div",{class:"block-link"},[e("p",null,"Escape From The Public")],-1);function sn(o,n){const t=E("router-link");return _(),v("div",ze,[Qe,Ze,e("div",Ge,[Ke,Xe,Ye,e("div",null,[e("div",We,[e("ul",null,[e("li",null,[d(t,{to:"blog/blog1.html"},{default:y(()=>[tn]),_:1})]),e("li",null,[d(t,{to:"blog/blog1.html"},{default:y(()=>[en]),_:1})]),e("li",null,[d(t,{to:"blog/blog1.html"},{default:y(()=>[nn]),_:1})]),e("li",null,[d(t,{to:"index.html"},{default:y(()=>[on]),_:1})])])])])])])}var ln=B(qe,[["render",sn]]);const an={},cn={class:"centered"},un={class:"tight"},rn=e("h1",null," i am a failure ",-1),dn=M(" Return Home ");function _n(o,n){const t=E("router-link");return _(),v("div",cn,[e("div",un,[rn,d(t,{to:"/"},{default:y(()=>[dn]),_:1})])])}var vn=B(an,[["render",_n]]);const fn=[{path:"/",component:He},{path:"/auth",component:Pe},{path:"/blogs",component:ye},{path:"/public-place",component:ln},{path:"/blog-edit",component:fe},{path:"/:pathMatch(.*)*",component:vn}],hn=wt({history:kt(),routes:fn}),pn=$t();St(Bt).use(hn).use(pn).use(tt).mount("#app");
