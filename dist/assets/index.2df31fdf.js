var at=Object.defineProperty;var j=Object.getOwnPropertySymbols;var it=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable;var q=(o,n,t)=>n in o?at(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t,C=(o,n)=>{for(var t in n||(n={}))it.call(n,t)&&q(o,t,n[t]);if(j)for(var t of j(n))ct.call(n,t)&&q(o,t,n[t]);return o};import{r as I,o as h,c as f,a as e,b as d,w as b,d as P,e as ut,f as G,g as c,h as M,i as S,t as z,j as Q,k as $,u as x,m as rt,M as dt,l as _t,n as X,F as A,p as K,q as k,v as B,s as vt,x as V,y as ht,z as Z,A as ft,B as pt,C as Y,D as gt,E as mt,G as bt,H as xt,I as yt,J as wt}from"./vendor.5e2f240a.js";const $t=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=t(l);fetch(l.href,a)}};$t();var N=(o,n)=>{const t=o.__vccOpts||o;for(const[s,l]of n)t[s]=l;return t};const kt={},St={class:"content-area"},It={class:"content-bar"},Et=P(" Home "),Pt=P(" Public Place "),Lt=P(" Blogs "),Tt=P(" Are you me? ");function Mt(o,n){const t=I("router-link"),s=I("router-view");return h(),f("div",St,[e("nav",It,[d(t,{to:"/"},{default:b(()=>[Et]),_:1}),d(t,{to:"/public-place"},{default:b(()=>[Pt]),_:1}),d(t,{to:"/blogs"},{default:b(()=>[Lt]),_:1}),d(t,{to:"/auth"},{default:b(()=>[Tt]),_:1})]),d(s)])}var Nt=N(kt,[["render",Mt]]);console.log({VITE_SUPABASE_URL:"https://tspfjdoknsrfrglseblj.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzcGZqZG9rbnNyZnJnbHNlYmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU1MjI1NzQsImV4cCI6MTk2MTA5ODU3NH0.Uf-K23bCVnxuQVjvQVSqeQoBHSr5B3qJfNaBduseNGk",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0});console.log("https://tspfjdoknsrfrglseblj.supabase.co");const Ot="https://tspfjdoknsrfrglseblj.supabase.co",At="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzcGZqZG9rbnNyZnJnbHNlYmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDU1MjI1NzQsImV4cCI6MTk2MTA5ODU3NH0.Uf-K23bCVnxuQVjvQVSqeQoBHSr5B3qJfNaBduseNGk",E=ut(Ot,At);function Bt(o,n,t="value"){return n[t]=!1,o.then(function(){n[t]=!0}),o.catch(function(){n[t]=!1}),o}function T(o,n,t="value"){return n[t]=!0,o.then(function(){n[t]=!1}),o.catch(function(){n[t]=!1}),o}const F={authenticated:!1,error:null,user:null,session:null},y=G(C({},F)),U={id:null,handle:null},O=G(C({},U)),W=c(!0);async function tt(o=null,n=null,t=null){if(y.authenticated)return;if(o=o!=null?o:localStorage.getItem("userEmail"),n=n!=null?n:localStorage.getItem("password"),o===void 0||n===void 0){y.authenticated=!1;return}const{user:s,session:l,error:a}=await E.auth.signIn({email:o,password:n});if(a){Object.assign(y,{authenticated:!1,error:a});return}Object.assign(O,(await E.from("user_data").select("*").eq("id",s.id)).data[0]),Object.assign(y,{authenticated:!0,user:s,session:l}),console.log("Logged in"),t&&(localStorage.setItem("userEmail",o),localStorage.setItem("password",n),console.log("Details saved locally"))}async function Vt(){localStorage.setItem("userEmail",void 0),localStorage.setItem("password",void 0),console.log("logging out..."),await E.auth.signOut(),Object.assign(y,F),Object.assign(O,U),console.log(F,U),console.log("logged out.")}T(tt(),W).then(()=>{console.log(y),console.log(O)});const R={loadPost:0,loadTitles:0,submitPost:0},Ct={loadPost:10,loadTitles:10,submitPost:3},et="No post with given name exists",Rt="Requests are too frequent!";function J(o){if(R[o]<Ct[o])R[o]+=1,setTimeout(()=>{R[o]-=1},5e3);else throw Error(Rt)}async function nt(o){J("loadPost");const{data:n,error:t}=await E.from("posts").select("content").eq("title",o);if(t)throw t;if(n.length===0)throw new Error(`${et}: ${o}`);return{title:o,content:n[0].content,resources:[]}}async function Ft(){J("loadTitles");const{data:o,error:n}=await E.from("posts").select("title");if(n)throw n;return o.map(({title:t})=>t)}async function Ut(o,n){if(J("submitPost"),!y.authenticated){console.error("Cant submit, not authenticated");return}const{error:t,data:s}=await E.from("posts").upsert({title:o,content:n,owner:O.id,modified:new Date().toISOString()});if(t)throw t;return s}const Jt=e("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"},null,-1),ot=M({props:{title:null,isLoading:{type:Boolean},externalText:null,externalResources:null},emits:["update:isLoading"],setup(o,{emit:n}){const t=o,s=c(!1);let l=!1;const a=S({get(){return t.isLoading},set(r){console.log("isLoading",r),n("update:isLoading",r)}});let i,u;if(t.externalText!==void 0)console.log("taking from editor"),i=z(t,"externalText"),u=z(t,"externalResources"),Q(i,function(){l=!1});else{const r=c("");i=$(r),u=c([]);const p=async()=>{t.title!==""&&({content:r.value,resources:u.value}=await T(Bt(nt(t.title),s),a),L())};p(),Q(()=>t.title,p)}const v=S(()=>`# ${t.title}
${i.value}`);function L(){if(!l){for(const r of document.querySelectorAll("#blog-preview script")){const p=document.createElement("script");p.innerHTML="{"+r.innerHTML+"}",r.parentElement.appendChild(p),r.remove()}l=!0}}return(r,p)=>(h(),f(A,null,[Jt,d(x(X),{id:"blog-preview",class:"card",source:x(v),html:!0,plugins:[{plugin:x(rt),options:{re:/<!--!([^]*?)!-->/g}},{plugin:x(dt),options:{engine:x(_t),delimiters:"dollars",katexOptions:{macros:{}}}}],onFocusin:L},null,8,["source","plugins"])],64))}}),Dt=e("label",{for:"markdown-input"}," Select Blog: ",-1),Ht={id:"title-list"},jt=["value"],qt=["value","disabled"],st=M({props:{disabled:{type:Boolean},buttonText:null,notExistsText:null,onSubmit:null},setup(o){const n=o,t=c([]),s=c(""),l=S(()=>!t.value.includes(s.value));async function a(){t.value=await Ft()}return K(a),(i,u)=>(h(),f(A,null,[Dt,k(e("input",{id:"markdown-input","onUpdate:modelValue":u[0]||(u[0]=v=>s.value=v),type:"search",list:"title-list",style:{width:"20em"}},null,512),[[B,s.value]]),e("datalist",Ht,[(h(!0),f(A,null,vt(t.value,v=>(h(),f("option",{key:v,value:v},null,8,jt))),128))]),e("input",{type:"submit",value:x(l)&&o.notExistsText?o.notExistsText:o.buttonText,disabled:o.disabled,style:{width:"7em"},onClick:u[1]||(u[1]=v=>n.onSubmit(s.value))},null,8,qt)],64))}}),zt=M({setup(o,{expose:n}){const t=c(0),s=c(!1),l=c(!1),a=c(""),i=c(null),u=c(""),v=c([]);async function L(_){if(_===a.value)return;const m=s.value;s.value=!1;try{let g;try{g=await nt(_)}catch(w){if(console.log(w),w.message===et)g={content:"",resources:[]};else throw w}await r(g.content),a.value=_,s.value=!0}catch(g){console.error("Something went wrong when loading the post:",g),s.value=m}}async function r(_){if(console.log(t.value),t.value!==0&&confirm("Save unsaved changes?")&&!await p())throw new Error("Save Failure");H(_,0,i.value.value.length),t.value=0}async function p(){console.log("saving...");try{const _=t.value,m=await T(Ut(a.value,u.value),l);return console.log("saved."),t.value-=_,!0}catch(_){return console.log("save failed."),console.log(_),!1}}function H(_,m=null,g=null){i.value.focus(),console.log(i.value.focus),m!==null&&(i.value.selectionStart=m),g!==null&&(i.value.selectionEnd=g),document.execCommand("insertText",!1,_)}const lt={changePost:L,save:p,saveable:$(s),isSaving:$(l),textMutated:$(t),title:$(a),content:$(u),resources:$(v)};return n(lt),K(()=>i.value.addEventListener("keydown",function(_){s.value&&(t.value+=1);let m;if(_.key==="Tab")_.preventDefault(),m="  ";else if(_.key==="Enter"){_.preventDefault();const g=this.value.lastIndexOf(`
`,this.selectionStart-1);let w=this.value.slice(g+1,this.selectionStart).search(/[^ ]/);w===-1&&(w=this.selectionStart-g-1),m=`
`+" ".repeat(w)}else return;H(m)})),(_,m)=>k((h(),f("textarea",{class:"flex-child-fill",ref_key:"editArea",ref:i,"onUpdate:modelValue":m[0]||(m[0]=g=>u.value=g)},`
        
    `,512)),[[B,u.value]])}});const D=o=>(gt("data-v-20c1541e"),o=o(),mt(),o),Qt={class:"content-column no-basis"},Zt={class:"content-row tight"},Gt={class:"content-column tight"},Xt=D(()=>e("label",{for:"toggle-autosave"},"Autosave",-1)),Kt={class:"content-row"},Yt={class:"content-column no-basis"},Wt={class:"content-bar"},te=D(()=>e("label",{for:"markdown-input"},"Post Text",-1)),ee=[te],ne={key:0},oe=["value","disabled"],se={class:"content-column no-basis"},le={class:"content-bar"},ae=D(()=>e("h2",null," Post Preview ",-1)),ie=["value"],ce=M({setup(o){const n=c({content:"",title:""}),t=c(!0),s=c(!1),l=c(!1),a=S(()=>t.value?"Show Full Preview":"Show Editor"),i=S(()=>n.value.textMutated?n.value.textMutated+" unsaved characters":"No title selected; changes will not be saved."),u=S(()=>!W.value&&y.authenticated);c("hello");function v(){s.value&&n.value.textMutated&&n.value.save()}return setInterval(()=>v()),(L,r)=>(h(),f("form",{style:{display:"flex"},onSubmit:r[3]||(r[3]=Y(()=>{},["prevent"]))},[e("div",Qt,[e("div",Zt,[e("div",null,[e("h2",null,' Editing "'+V(n.value.title)+'" ',1)]),e("h2",null,[d(st,{disabled:l.value,"on-submit":n.value.changePost,"button-text":l.value?"Loading...":"Load","not-exists-text":"New"},null,8,["disabled","on-submit","button-text"])]),e("div",Gt,[e("div",null,[k(e("input",{"onUpdate:modelValue":r[0]||(r[0]=p=>s.value=p),type:"checkbox",name:"toggle-autosave"},null,512),[[ht,s.value]]),Xt])])]),e("div",Kt,[k(e("div",Yt,[e("div",Wt,[e("h2",{style:ft("font-style: "+(n.value.textMutated===0?"normal":"italic"))},ee,4),k(e("p",{style:{"flex-grow":"1"}},V(x(i)),513),[[Z,n.value.textMutated>0]]),x(u)?(h(),f("span",ne,[e("input",{type:"submit",value:n.value.isSaving?"Saving...":"Save",disabled:n.value.isSaving||!n.value.saveable,onClick:r[1]||(r[1]=(...p)=>n.value.save&&n.value.save(...p))},null,8,oe)])):pt("",!0)]),d(zt,{ref_key:"editor",ref:n},null,512)],512),[[Z,t.value]]),e("div",se,[e("div",le,[ae,e("span",null,[e("input",{type:"submit",value:x(a),onClick:r[2]||(r[2]=p=>t.value=!t.value)},null,8,ie)])]),d(ot,{title:n.value.title,"external-text":n.value.content},null,8,["title","external-text"])])])])],32))}});var ue=N(ce,[["__scopeId","data-v-20c1541e"]]);const re={class:"content-column"},de=e("br",null,null,-1),_e={class:"content-row tight"},ve=P(" Edit "),he=e("br",null,null,-1),fe=M({setup(o){const n=c(""),t=c(!1);function s(l){console.log(l),n.value=l}return(l,a)=>{const i=I("router-link");return h(),f("div",re,[de,e("div",_e,[e("div",null,[d(st,{"button-text":t.value?"Loading":"Load",disabled:t.value,"on-submit":s},null,8,["button-text","disabled"])]),d(i,{to:"/blog-edit"},{default:b(()=>[ve]),_:1})]),he,d(ot,{"is-loading":t.value,"onUpdate:is-loading":a[0]||(a[0]=u=>t.value=u),title:n.value},null,8,["is-loading","title"])])}}}),pe={class:"nugget-container"},ge=["onSubmit"],me={key:0},be=["disabled"],xe={key:1},ye=e("td",null,[e("label",{for:"email"},"Email:")],-1),we=e("td",null,[e("label",{for:"password"},"Password:")],-1),$e=["value","disabled"],ke={setup(o){const n=c(""),t=c(""),s=c(!1);async function l(){try{console.log("logging..."),await T(tt(n.value,t.value,!0),s)}catch(i){alert(i.error_description||i.error_message)}}async function a(){try{console.log("logging..."),await T(Vt(),s)}catch(i){alert(i.error_description||i.error_message)}}return(i,u)=>(h(),f("div",pe,[e("form",{class:"card tight",onSubmit:Y(l,["prevent"])},[x(y).authenticated?(h(),f("div",me,[e("h1",null,"Welcome, "+V(x(O).handle),1),e("button",{disabled:s.value,onclick:a},V(s.value?"Bye...":"Log Out"),9,be)])):(h(),f("table",xe,[e("tr",null,[ye,e("td",null,[k(e("input",{"onUpdate:modelValue":u[0]||(u[0]=v=>n.value=v),class:"inputField",type:"email",name:"email"},null,512),[[B,n.value]])])]),e("tr",null,[we,e("td",null,[k(e("input",{"onUpdate:modelValue":u[1]||(u[1]=v=>t.value=v),class:"inputField",type:"password",name:"password"},null,512),[[B,t.value]])])]),e("tr",null,[e("input",{type:"submit",value:s.value?"loading":"Log In",disabled:s.value},null,8,$e)])]))],40,ge)]))}};var Se="/assets/blog_button.8c697ef8.png",Ie="/assets/public_button.11df71ad.png";const Ee={},Pe=e("h1",null,"This is the main page yay!",-1),Le={class:"card"},Te=e("div",{class:"text-content"},[e("h2",null,"What stuff exists here"),e("p",null," This site has a small web app I made for myself to write posts. Perhaps once the organization gets musty enough a system will grow naturally, just like mould on a sandwich. ")],-1),Me={class:"content-column"},Ne={class:"content-row"},Oe={class:"flex-child-fill square mid-margin"},Ae=e("img",{class:"img-btn",src:Se},null,-1),Be={class:"flex-child-fill square mid-margin"},Ve=e("img",{class:"img-btn",src:Ie},null,-1);function Ce(o,n){const t=I("router-link");return h(),f(A,null,[Pe,e("div",Le,[Te,e("div",Me,[e("div",Ne,[e("div",Oe,[d(t,{to:"/blog-edit"},{default:b(()=>[Ae]),_:1})]),e("div",Be,[d(t,{to:"/public-place"},{default:b(()=>[Ve]),_:1})])])])])],64)}var Re=N(Ee,[["render",Ce]]),Fe="/assets/fetus.2d52290a.png";const Ue={},Je={class:"card"},De=e("div",{class:"title"},[e("h1",null,"Public Place")],-1),He=e("div",{class:"text-content"},[e("h1",null,"Hello Stranger!"),e("p",null," This is the Public Place. For Public People. Hellooo the public! Please gaze at my various credentials or whatever. ")],-1),je={class:"text-content"},qe=e("h1",null," About Me",-1),ze=e("img",{class:"side-img",src:Fe},null,-1),Qe=e("p",null," I dont feel particularly inclined to write about boring stuff right now. So youre going to have to settle for a nice picture of me: ",-1),Ze={class:"link-list"},Ge=e("div",{class:"block-link"},[e("p",null,"Resume BROKEN PLEASE FIX ME")],-1),Xe=e("div",{class:"block-link"},[e("p",null,"GitHub BROKEN PLEASE FIX ME")],-1),Ke=e("div",{class:"block-link"},[e("p",null,"Linkedin BROKEN PLEASE FIX ME")],-1),Ye=e("div",{class:"block-link"},[e("p",null,"Escape From The Public")],-1);function We(o,n){const t=I("router-link");return h(),f("div",Je,[De,He,e("div",je,[qe,ze,Qe,e("div",null,[e("div",Ze,[e("ul",null,[e("li",null,[d(t,{to:"blog/blog1.html"},{default:b(()=>[Ge]),_:1})]),e("li",null,[d(t,{to:"blog/blog1.html"},{default:b(()=>[Xe]),_:1})]),e("li",null,[d(t,{to:"blog/blog1.html"},{default:b(()=>[Ke]),_:1})]),e("li",null,[d(t,{to:"index.html"},{default:b(()=>[Ye]),_:1})])])])])])])}var tn=N(Ue,[["render",We]]);const en={},nn={class:"centered"},on={class:"tight"},sn=e("h1",null," i am a failure ",-1),ln=P(" Return Home ");function an(o,n){const t=I("router-link");return h(),f("div",nn,[e("div",on,[sn,d(t,{to:"/"},{default:b(()=>[ln]),_:1})])])}var cn=N(en,[["render",an]]);const un=[{path:"/",component:Re},{path:"/auth",component:ke},{path:"/blogs",component:fe},{path:"/public-place",component:tn},{path:"/blog-edit",component:ue},{path:"/:pathMatch(.*)*",component:cn}],rn=bt({history:xt(),routes:un}),dn=yt();wt(Nt).use(rn).use(dn).use(X).mount("#app");
